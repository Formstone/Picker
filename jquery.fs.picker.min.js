/*
 * Picker Plugin
 * @author Ben Plum
 * @version 0.2.6
 *
 * Copyright Â© 2012 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */

if(jQuery)(function($){var options={customClass:""};var pub={defaults:function(opts){options=$.extend(options,opts||{});return $(this);},disable:function(){return $(this).each(function(i){var $input=$(this),$picker=$input.parent(".picker");$input.prop("disabled",true);$picker.addClass("disabled");});},enable:function(){return $(this).each(function(i){var $input=$(this),$picker=$input.parent(".picker");$input.prop("disabled",false);$picker.removeClass("disabled");});},destroy:function(){return $(this).each(function(i){var $input=$(this),$picker=$input.parent(".picker"),$handle=$picker.find(".picker-handle"),$label=$("label[for="+$input.attr("id")+"]");$picker.off(".picker");$handle.remove();$input.off(".picker").removeClass("picker-element").unwrap();$label.removeClass("picker-label");});}};function _init(opts){opts=opts||{};var settings=$.extend({},options,opts);return $(this).each(function(i){var $input=$(this);if(!$input.data("picker")){var $label=$("label[for="+$input.attr("id")+"]"),$merged=$($.merge($.merge([],$input),$label)),type=$input.attr("type"),typeClass="picker-"+(type=="radio"?"radio":"checkbox"),group=$input.attr("name");$merged.wrapAll('<div class="picker '+typeClass+' '+settings.customClass+'" />');$input.addClass("picker-element").after('<div class="picker-handle"><div class="picker-flag" /></div>');$label.addClass("picker-label");var $picker=$input.parent(".picker");var $handle=$picker.find(".picker-handle");if($input.is(":checked")){$picker.addClass("checked");}if($input.is(":disabled")){$picker.addClass("disabled");}var data=$.extend({$picker:$picker,$input:$input,$handle:$handle,$label:$label,group:group,isRadio:(type=="radio"),isCheckbox:(type=="checkbox")},settings);$input.on("focus.picker",data,_onFocus).on("blur.picker",data,_onBlur).on("change.picker",data,_onChange).on("deselect.picker",data,_onDeselect);$picker.on("click.picker",".picker-handle",data,_onClick).data("picker",data);}});}function _onClick(e){e.preventDefault();e.stopPropagation();var data=e.data;if(!data.$input.is(":disabled")){if(data.$input.is(":checked")){if(!data.isRadio){_onDeselect(e);}}else{_onSelect(e);}}}function _onChange(e){var data=e.data;if(!data.$input.is(":disabled")){if(data.$input.is(":checked")){_onSelect(e);}else{_onDeselect(e);}}}function _onSelect(e){var data=e.data;if(typeof data.group!=="undefined"&&data.isRadio){$('input[name="'+data.group+'"]').not(data.$input).trigger("deselect");}data.$input.prop("checked",true);data.$picker.addClass("checked");}function _onDeselect(e){var data=e.data;data.$input.prop("checked",false);data.$picker.removeClass("checked");}function _onFocus(e){e.data.$picker.addClass("focus");}function _onBlur(e){e.data.$picker.removeClass("focus");}$.fn.picker=function(method){if(pub[method]){return pub[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return _init.apply(this,arguments);}return this;};})(jQuery);
